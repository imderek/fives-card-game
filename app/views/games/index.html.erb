<%= turbo_stream_from "games" %>

<div class="max-w-7xl mx-auto px-4 py-6 pb-12">
  <div class="flex flex-row justify-between mb-5">
    <h1 class="text-3xl font-bold text-white dark:text-white">Lobby</h1>
    <%= button_to "Sign Out", destroy_user_session_path, 
        method: :delete,
        class: "px-4 py-2 text-sm text-white rounded-lg dark:bg-slate-500/50" %>
  </div>

  <!-- Start New Game -->
  <div class="mb-5 text-center bg-white/30 dark:bg-slate-500/50 dark:text-white p-6 rounded-lg shadow-xl">
    <h2 class="text-xl font-semibold mb-3">Start a New Game</h2>
    <div class="flex justify-center gap-4">
      <%= link_to "Play vs Bot",
                  new_game_path(type: :bot), 
                  class: "px-4 py-2 bg-white text-white rounded-lg hover:bg-red-400 dark:bg-red-500 dark:hover:bg-red-400" %>
      <%#= link_to "Play vs Player", 
                  new_game_path(type: :pvp), 
                  class: "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" %>
    </div>
  </div>

  <!-- Leaderboard -->
  <h1 class="text-xl font-medium mb-4 dark:text-white">Leaderboard</h1>
  <div class="grid gap-4 mb-5">
    <div class="text-sm flex flex-col gap-2 justify-between bg-white dark:bg-slate-500/50 dark:text-white py-3 px-3 rounded-lg shadow-xl">
      <% @leaderboard.each_with_index do |user, index| %>
        <!-- User row -->
        <div class="flex flex-row justify-between items-center px-1">
          <!-- Left column -->
          <div class="flex flex-row gap-1 items-center">
            <div class="inline-block w-4 text-slate-400"><%= index + 1 %></div>
            <div class="mr-2 w-6 h-6 rounded-full <%= ['bg-red-500', 'bg-blue-500', 'bg-green-500', 'bg-purple-500', 'bg-yellow-500', 'bg-pink-500', 'bg-indigo-500'][index % 7] %> text-white flex items-center justify-center"><%= user.email.first.upcase %></div>
            <div class="font-medium"><%= user.email.capitalize %></div>
          </div>
          <!-- Right column -->
          <div class=""><%= user.wins %></div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Recent Games -->
  <h1 class="text-xl font-semibold mb-4 dark:text-white">Recent Games</h1>
  <div id="games_list" class="grid gap-4">
    <% @games.each do |game| %>
      <%= render "games/game", game: game %>
    <% end %>
  </div>

</div>